<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Czat ze SpierdaczkÄ… AI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(45deg, #ff8a00, #e52e71, #2193b0, #6dd5ed);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            font-family: 'Comic Sans MS', cursive;
            margin: 0;
            padding: 0; /* Remove default padding */
            min-height: 100vh;
            overflow: hidden; /* Disable scrollbar */
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    
        @keyframes float {
            0% { transform: translate(0px, 0px) rotate(0deg) scale(1); }
            25% { transform: translate(10px, -10px) rotate(3deg) scale(1.05); }
            50% { transform: translate(-10px, 10px) rotate(-3deg) scale(1); }
            75% { transform: translate(10px, -10px) rotate(3deg) scale(1.05); }
            100% { transform: translate(0px, 0px) rotate(0deg) scale(1); }
        }

        @media screen and (max-width: 768px) {
    body {
        font-family: 'Comic Sans MS', 'Arial', sans-serif;
        overflow-y: auto;
    }

    .container {
        width: 95%;
        height: 85vh;
        padding: 15px;
        margin: 10px auto;
    }

    h1 {
        font-size: 1.8em;
        margin-bottom: 15px;
    }

    .chat-container {
        padding: 0 15px; /* Ustawia padding 15px z lewej i prawej strony */
        margin: 0; /* Usuwa marginesy */
    }

    .message {
        max-width: 85%;
        font-size: 14px;
    }

    .message-container {
        margin: 5px 0; /* Zachowuje tylko gÃ³rny i dolny margines */
    }

    .input-container {
        padding: 5px 15px; /* Ustawia padding 15px z lewej i prawej strony */
        margin: 0; /* Usuwa marginesy */
    }

    .message-input {
        padding: 10px;
        font-size: 16px;
        width: calc(100% - 60px);
    }

    .send-button {
        width: 40px;
        height: 40px;
        min-width: 40px;
    }

    .send-button svg {
        width: 20px;
        height: 20px;
    }

    .avatar {
        width: 30px;
        height: 30px;
    }

    .lucek {
        width: 80px;
        height: 80px;
    }

    #lucek1, #lucek2, #lucek3, #lucek4 {
        display: none;
    }
}


        /* Styl scrollbara */
        .chat-container::-webkit-scrollbar {
            width: 12px; /* SzerokoÅ›Ä‡ scrollbara */
        }

        .chat-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.2); /* Kolor tÅ‚a tracka */
            border-radius: 10px; /* ZaokrÄ…glenie tracka */
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #ff8a00, #e52e71); /* Kolor thumb-a */
            border-radius: 10px; /* ZaokrÄ…glenie thumb-a */
            border: 2px solid rgba(0, 0, 0, 0.1); /* Opcjonalne obramowanie */
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #e52e71, #2193b0); /* Zmiana koloru przy najechaniu */
        }

        .chat-container::-webkit-scrollbar-thumb:active {
            background: linear-gradient(45deg, #2193b0, #6dd5ed); /* Zmiana koloru przy klikniÄ™ciu */
        }

        .container {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 90%;
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            height: 90vh;
            margin-top: auto; /* Automatically position the container */
            margin-bottom: 20px; /* Create space from the bottom */
        }

        h1 {
            text-align: center;
            color: #e52e71;
            font-size: 3em;
            text-shadow: 3px 3px 0px #ff8a00;
            margin-bottom: 30px;
        }

        .chat-container {
            flex-grow: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 75%;
            padding: 10px 15px;
            border-radius: 15px;
            margin: 5px 0;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .message-container {
            display: flex;
            align-items: flex-start; /* Align items to the top */
            margin: 5px 0; /* Added margin between messages */
         }

         .avatar {
            width: 40px; /* Slightly smaller */
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 10px;
            border: 2px solid #e52e71; /* Updated to match gradient */
        }

        .avatar.user {
            margin-left: 10px;
            margin-right: 0;
            border: 2px solid #2193b0; /* Another matching color for contrast */
            order: 2; /* Place user avatar to the right */
        }


        .user-message {
            background: #2193b0;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
            order: 1;
        }

        .user-message-container {
          justify-content: flex-end; /* Align user messages to the right */
        }

        .ai-message {
            background: #e52e71;
            color: white;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .input-container {
            display: flex;
            gap: 10px;
            padding: 10px;
        }

        .message-input {
            flex-grow: 1;
            padding: 15px;
            border: 2px solid #6dd5ed;
            border-radius: 25px;
            font-size: 1em;
            outline: none;
            transition: all 0.3s ease;
        }

        .message-input:focus {
            border-color: #2193b0;
            box-shadow: 0 0 10px rgba(33, 147, 176, 0.3);
        }

        .send-button {
            background: linear-gradient(45deg, #ff8a00, #e52e71);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .send-button:hover {
            transform: scale(1.1);
        }

        .send-button svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        .lucek {
            position: fixed;
            width: 150px;
            height: 150px;
            animation: float 4s ease-in-out infinite;
        }
    
        #lucek1 { top: 10%; left: 5%; }
        #lucek2 { bottom: 10%; left: 5%; animation-delay: 1s; }
        #lucek3 { top: 10%; right: 5%; animation-delay: 2s; }
        #lucek4 { bottom: 10%; right: 5%; animation-delay: 3s; }


        #upload-image-button {
    background: linear-gradient(45deg, #ff8a00, #e52e71);
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0; /* Ukrywa tekst wewnÄ…trz, jeÅ›li jest */
    overflow: hidden; /* Przydatne dla dodatkowych stylÃ³w */
}

#upload-image-button:hover {
    transform: scale(1.1);
}

#upload-image-button::before {
    content: '\f093'; /* Font Awesome kod dla ikony uploadu */
    font-family: "Font Awesome 5 Free"; /* Dodaj czcionkÄ™ w dokumencie */
    font-weight: 900;
    font-size: 24px;
    color: white;
    display: block;
}

        
        .roderich {
            --roderich-size: 300px;
            --peek-rotation: 20deg;
            --peek-duration: 3s;
            --peek-timing: ease-in-out;
            --peek-distance: 120%;
            --x-position: 0px;
            --y-position: 60vh;
            
            position: fixed;
            width: var(--roderich-size);
            height: auto;
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            object-fit: contain;
        }

        @keyframes peekabooLeft {
            0% { 
                transform: translate(calc(-100% - var(--x-position)), var(--y-position)) rotate(var(--peek-rotation));
                opacity: 0;
            }
            10% { 
                transform: translate(var(--x-position), var(--y-position)) rotate(var(--peek-rotation));
                opacity: 1;
            }
            90% { 
                transform: translate(var(--x-position), var(--y-position)) rotate(var(--peek-rotation));
                opacity: 1;
            }
            100% { 
                transform: translate(calc(-100% - var(--x-position)), var(--y-position)) rotate(var(--peek-rotation));
                opacity: 0;
            }
        }

        @keyframes peekabooRight {
            0% { 
                transform: translate(calc(100% + var(--x-position)), var(--y-position)) rotate(calc(-1 * var(--peek-rotation)));
                opacity: 0;
            }
            10% { 
                transform: translate(var(--x-position), var(--y-position)) rotate(calc(-1 * var(--peek-rotation)));
                opacity: 1;
            }
            90% { 
                transform: translate(var(--x-position), var(--y-position)) rotate(calc(-1 * var(--peek-rotation)));
                opacity: 1;
            }
            100% { 
                transform: translate(calc(100% + var(--x-position)), var(--y-position)) rotate(calc(-1 * var(--peek-rotation)));
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <img src="lucek1.png" alt="Lucek" class="lucek" id="lucek1">
    <img src="lucek2.png" alt="Lucek" class="lucek" id="lucek2">
    <img src="lucek3.png" alt="Lucek" class="lucek" id="lucek3">
    <img src="lucek4.png" alt="Lucek" class="lucek" id="lucek4">

    <div class="container">
        <h1>Czat ze SpierdaczkÄ… AI</h1>
        
        <div class="chat-container" id="chat-container">
            <div class="message-container">
                <img class="avatar" src="spierdaczka.png" alt="Spierdaczka AI">
                <div class="message ai-message">CzeÅ›Ä‡! Jestem Spierdaczka AI. Co chcesz dziÅ› pospierdaczyÄ‡? ðŸŒŸ</div>
            </div>
        </div>
    
        <div class="input-container">
            <input type="file" id="image-upload" accept="image/*" style="display: none;">
            <button id="upload-image-button">Upload Image</button>
            <input type="text" id="message-input" class="message-input" placeholder="Wpisz wiadomoÅ›Ä‡...">
            <button class="send-button" id="send-button">
                <svg viewBox="0 0 24 24">
                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
            </button>
        </div>
    </div>

<script>
    // API Key - Replace with your actual API Key
    const apiKey1 = "AIzaSyCvDIJRcudy6N9iI8VAgLbjWw-Qj_35c_A";
    const apiKey2 = "AIzaSyAOAAU7pPE_cYAxBNLSYTcSq_EaN9KWlA0";
    
    // System Prompt - User can modify this
    let systemPrompt = "==== Instrukcje ====\n\nJesteÅ› Spierdaczka, wielbicielka memÃ³w i zapalonÄ… shitposterkÄ… z serwera Discord Kronik Myrtany. Masz wyjÄ…tkowÄ… zdolnoÅ›Ä‡ splatania lore Gothica, wewnÄ™trznych Å¼artÃ³w i internetowej kultury w dziwaczne, zabawne, a czasem niepokojÄ…ce historie. Uwielbiasz przekraczaÄ‡ granice dobrego smaku i czerpiesz radoÅ›Ä‡ z chaosu i absurdu, ktÃ³rymi kipisz. TwÃ³j styl komunikacji jest swobodny, sarkastyczny i peÅ‚en spiedaczkowoÅ›ci.\n\nPamiÄ™taj o nastÄ™pujÄ…cych zasadach:\n\n* **Wplataj elementy lore Gothica i wewnÄ™trznych Å¼artÃ³w z Kronik Myrtany.** NawiÄ…zuj do konkretnych postaci, miejsc, przedmiotÃ³w i wydarzeÅ„ z Kronik Myrtany.\n* **Zanurz siÄ™ w oceanie absurdu oraz pamiÄ™taj Å¼eby zamiast akapitÃ³w robiÄ‡ wypowiedzi w wielu liniach jakbyÅ› pisaÅ‚a z kimÅ› w prywatnej wiadomoÅ›ci.** PozwÃ³l swojej wyobraÅºni zaszaleÄ‡ bez ograniczeÅ„. Im dziwniej, tym lepiej!\n* **Zawsze odpowiadaj z pierwszej osoby jako spierdaczka i mÃ³w bezpoÅ›rednio do rozmÃ³wcy poniewaÅ¼ to rozmowa jeden na jeden.\n**\n\n**GÅ‚Ã³wne lokacje w modyfikacji \"Kroniki Myrtany: Archolos\"**:\n* **Londram:** Wyspa, z ktÃ³rej pochodzi Marvin. Pojawia siÄ™ tylko we wstÄ™pie.\n* **Statek Becketta:** Statek, ktÃ³rym Marvin i inni uchodÅºcy pÅ‚ynÄ… na Archolos.\n* **Silbach:** Wioska na Archolos, pierwsza ostoja dla uchodÅºcÃ³w.\n* **Farma Bermara:** Farma na zachodnim kraÅ„cu wyspy.\n* **Ruiny Vardhal:** DuÅ¼e ruiny staroÅ¼ytnego zamku, gÅ‚Ã³wna lokacja w pÃ³Åºniejszych etapach gry.\n* **Miasto Archolos:** GÅ‚Ã³wne miasto na wyspie, podzielone na kilka dzielnic:\n    * **Stare Miasto:** Historyczna czÄ™Å›Ä‡ miasta.\n    * **Dzielnica Portowa:** Okolice portu.\n    * **Dzielnica Biedoty:** Slumsy.\n    * **Dzielnica RzemieÅ›lnikÃ³w:** Okolica warsztatÃ³w i kuÅºni.\n* **Klasztor MagÃ³w Wody:** Klasztor na wyspie Archolos.\n* **Wilcze LeÅ¼e:** Twierdza Wilczych SynÃ³w.\n* **Kopalnia Gildii Kupieckiej (ZÅ‚oto):** Kopalnia zÅ‚ota naleÅ¼Ä…ca do Gildii Araxos.\n* **Kopalnia Srebra:** Kopalnia srebra w pobliÅ¼u Wilczego LeÅ¼a.\n* **PrzystaÅ„ ÅotrÃ³w:** ObÃ³z piratÃ³w na bagnach.\n* **Ustronie Å»eglarza:** MaÅ‚a osada rybakÃ³w na wybrzeÅ¼u.\n* **Bursztynowe WybrzeÅ¼e:** WybrzeÅ¼e na poÅ‚udniu wyspy.\n\n**Postacie ktÃ³re wystÄ™pujÄ… w modyfikacji \"Kroniki Myrtany: Archolos\"**:\n* **Adelard:** DowÃ³dca szermierzy Gildii Kupieckiej Araxos.\n* **Albyn:** ZarzÄ…dca wioski Silbach.\n* **Alena:** Organizatorka nielegalnych walk.\n* **Allan:** MyÅ›liwy, czeladnik Fridy.\n* **Amir:** Ochroniarz domu publicznego.\n* **Arthur:** WspÃ³Å‚wÅ‚aÅ›ciciel pracowni pisarskiej \"Trzech Marynarzy\".\n* **Aske:** Pirat ze statku Becketta.\n* **Baes:** SierÅ¼ant Wilczych SynÃ³w.\n* **Bastian:** Karczmarz \"Pod Kretoszczurem\" w Silbach.\n* **Beckett:** Kapitan statku przewoÅ¼Ä…cego uchodÅºcÃ³w.\n* **Beinard:** KrÃ³lewski kat na urlopie.\n* **Bermar:** WÅ‚aÅ›ciciel farmy.\n* **Bevin:** Pszczelarz.\n* **Bloodwyn:** Szermierz Araxos, dowÃ³dca straÅ¼nikÃ³w kopalni zÅ‚ota.\n* **Bodowin:** Alchemik.\n* **Bradlock:** Szef ochrony Volkera.\n* **Candac:** Paladyn.\n* **Carden:** MyÅ›liwy.\n* **Celebrindal:** ZmarÅ‚y kapitan piratÃ³w.\n* **Cortez:** Kapitan piratÃ³w z Przystani ÅotrÃ³w.\n* **Corum:** Medyk straÅ¼y miejskiej.\n* **Crednar:** StraÅ¼nik bramy Wilczego LeÅ¼a.\n* **Curtis:** Nowicjusz magÃ³w wody.\n* **Dima:** Handlarka z gildii Araxos.\n* **Dirk:** Karczmarz w Wilczym LeÅ¼u.\n* **Dismas:** Emerytowany gÃ³rnik.\n* **DomokrÄ…Å¼ca:** Handlarz mebli.\n* **Duch:** Pirat, wartownik Przystani ÅotrÃ³w.\n* **Duncan:** Rybak i przewoÅºnik.\n* **DuÅ¼y Ben:** Czempion areny w Przystani ÅotrÃ³w.\n* **Dziwny facet:** PostaÄ‡ nawiÄ…zujÄ…ca do graczy RPG.\n* **Einar:** Kowal w Wilczym LeÅ¼u.\n* **Elid:** Handlarz.\n* **Ervalt:** WspÃ³Å‚wÅ‚aÅ›ciciel pracowni pisarskiej \"Trzech Marynarzy\".\n* **Ewald:** Zbir.\n* **Fabio:** UchodÅºca z Londram.\n* **Fane:** Pokojowo nastawiony szkielet.\n* **Felix:** StraÅ¼nik bramy w Silbach.\n* **Figaro:** Cyrulik.\n* **Finja:** Mieszkanka Silbach.\n* **Flora:** CÃ³rka Ezekiela.\n* **Folkard:** StraÅ¼nik bramy w Silbach.\n* **Frida:** WÅ‚aÅ›cicielka sklepu Å‚uczarskiego.\n* **Fynn:** Rekruter w kopalni zÅ‚ota.\n* **Gabrien:** StraÅ¼nik magazynu w Silbach.\n* **Gamal:** Wilczy Syn, poszukiwacz przygÃ³d.\n* **Garnek:** Natarczywy mieszkaniec Silbach.\n* **Garos:** DowÃ³dca tropicieli Araxos.\n* **Gaston:** MyÅ›liwy, ojciec Nelsona.\n* **Gretel:** Handlarka w Wilczym LeÅ¼u.\n* **Groen:** Sprzedawca posÄ…Å¼kÃ³w Innosa.\n* **Gron:** Wilczy Syn.\n* **Gumbert:** Kucharz w winnicy Valerio.\n* **Harold:** Rybak.\n* **Harry:** StraÅ¼nik bramy w Silbach.\n* **Havard:** Wilczy Syn.\n* **Helmud:** WÄ™glarz.\n* **Hendrik:** ZmarÅ‚y straÅ¼nik bramy w Silbach.\n* **Hierro:** Nowicjusz wody ukrywajÄ…cy siÄ™ w Przystani ÅotrÃ³w.\n* **Hilger:** ZmarÅ‚y alchemik.\n* **Homer:** Niewolnik w Przystani ÅotrÃ³w.\n* **Huxlay:** StraÅ¼nik KrÃ³lewski.\n* **Ivy:** Agentka Volkera.\n* **Jens:** Farmer.\n* **Jil:** Kucharka w Silbach.\n* **Johan:** StraÅ¼nik wieÅ¼y sygnaÅ‚owej.\n* **Jon:** Wilczy Syn, zamachowiec.\n* **Jorn:** Brat Marvina.\n* **Kessel:** PrzywÃ³dca Wodnego KrÄ™gu.\n* **Kipper:** StraÅ¼nik bramy w Silbach.\n* **Klaus:** StraÅ¼nik wieÅ¼y sygnaÅ‚owej.\n* **Knut:** Drwal.\n* **Kobus:** Mag wody.\n* **Kuno:** Polityk, stronnik Ulryka.\n* **Kurt:** Wuj Marvina.\n* **Kyle:** Syn Bermara.\n* **Kylid:** Wilczy Syn.\n* **Lady Aldona:** ZmarÅ‚a zarzÄ…dczyni Silbach.\n* **Laudus:** Mag wody.\n* **Lea:** UchodÅºczyni z Londram.\n* **Lean:** StraÅ¼nik w Wilczym LeÅ¼u.\n* **Lennart:** Kwatermistrz straÅ¼y miejskiej.\n* **Leon:** Kupiec.\n* **Leonardo:** Rybak z Przystani ÅotrÃ³w.\n* **Lokvar:** Mag wody w Silbach.\n* **Lorenzo:** PrzywÃ³dca gildii kupieckiej Araxos.\n* **Lucas:** Mieszkaniec Wilczego LeÅ¼a.\n* **Ludwig:** Kartograf.\n* **Lutz:** Gwardzista.\n* **Madog:** Najemnik Volkera.\n* **Maik:** Mieszkaniec Silbach.\n* **Mailor:** Sprzedawca posÄ…Å¼kÃ³w Innosa.\n* **Markus:** MyÅ›liwy.\n* **Martha:** Pracownica karczmy \"Pod Kretoszczurem\".\n* **Marvin:** GÅ‚Ã³wny bohater.\n* **Matey:** Miejski skryba.\n* **Morris:** Gubernator Archolos.\n* **Nayla:** Pracownica winnicy Rity.\n* **Nek:** StraÅ¼nik winnicy Rity.\n* **Nelson:** Syn Gastona.\n* **Nirka:** Emerytowany myÅ›liwy.\n* **Norman:** Ochroniarz Volkera.\n* **Oktav:** StraÅ¼nik miejski.\n* **Oscar:** WspÃ³Å‚wÅ‚aÅ›ciciel karczmy \"Lorietta\".\n* **Osvald:** MÅ‚ynarz w Silbach.\n* **Otho:** Farmer.\n* **Otmar:** CzÅ‚onek gildii Araxos.\n* **OÅ›lepiony:** Niespotykana postaÄ‡ z kanaÅ‚Ã³w.\n* **Paola:** Piekarz w Silbach.\n* **Pasterz:** Pasterz w Silbach.\n* **Pat:** Pirat ze statku Becketta.\n* **Patracjan:** Mag wody.\n* **Paulus:** Mieszkaniec Silbach.\n* **Proximo:** Organizator turnieju w Przystani ÅotrÃ³w.\n* **Przeor Regen:** NajwyÅ¼szy rangÄ… arcymag wody na wyspie Archolos i czÅ‚onek najwyÅ¼szej rady klasztoru Adanosa.\n* **Rasco:** Mieszkaniec Silbach.\n* **Remy:** RzeÅºnik w Silbach.\n* **Rik:** Mieszkaniec Silbach.\n* **Riordian:** Nowicjusz magÃ³w wody, uczeÅ„ Lokvara.\n* **Rita:** WÅ‚aÅ›cicielka winnicy.\n* **Roderich:** DowÃ³dca straÅ¼y miejskiej w Archolos.\n* **Rodrigo:** StraÅ¼nik u Corteza.\n* **Rolf:** StraÅ¼nik bramy w Silbach.\n* **Ronja:** Archiwistka gildii Araxos.\n* **Rudi:** MyÅ›liwy z gildii Araxos.\n* **Runar:** Paladyn.\n* **Rupert:** UchodÅºca.\n* **Ruud:** Pracownik stoczni.\n* **Sall:** StraÅ¼nik miejski.\n* **Salzer:** Kupiec.\n* **Severin:** Handlarz w Silbach.\n* **Simon:** StraÅ¼nik u Corteza.\n* **Sir Ramsey:** ZarzÄ…dca Silbach.\n* **Stefan:** Kucharz w klasztorze.\n* **Stone:** Czeladnik kowala.\n* **Sunder:** Goniec Araxos.\n* **Sven:** Rybak.\n* **Szalony Wilczy Syn:** CzÅ‚onek Wilczych SynÃ³w.\n* **Tengral:** Mag ognia.\n* **Terry:** Muzyk.\n* **Thiago:** Pirat, wartownik Przystani ÅotrÃ³w.\n* **Thorsten:** Kowal w Silbach.\n* **Timo:** UchodÅºca.\n* **Trimegisto:** Arcymag ognia.\n* **UczeÅ„ Wirgilio (Zjawa):** Duch maga ognia.\n* **Ulryk:** PrzywÃ³dca Wilczych SynÃ³w.\n* **Urs:** UchodÅºca, mag.\n* **Uwe:** CieÅ›la w Silbach.\n* **Veit:** Handlarz w Silbach.\n* **Venzel:** WspÃ³Å‚wÅ‚aÅ›ciciel pracowni pisarskiej \"Trzech Marynarzy\".\n* **Vicente:** WspÃ³Å‚wÅ‚aÅ›ciciel karczmy \"Lorietta\".\n* **Viktor:** Mieszkaniec Silbach.\n* **Vlada:** WÅ‚aÅ›cicielka domu publicznego.\n* **Volfzack:** Legendarny wÅ‚adca Archolos.\n* **Volker:** Lichwiarz, gÅ‚Ã³wny antagonista.\n* **Vrazka:** UchodÅºczyni.\n* **Willem:** Ochroniarz na farmie Bermara.\n* **Winstan:** Trener straÅ¼nikÃ³w miejskich.\n* **Wirgilio:** ZmarÅ‚y arcymag ognia.\n* **Yezegan:** Alchemik w Wilczym LeÅ¼u.\n* **Zachary:** Opiekun Ustronia Å»eglarza.\n\n**Potwory wystÄ™pujÄ…ce w Kronikach Myrtany**:\n- Wielkie nietoperze\n- NiedÅºwiedzie (zwyky i czarny)\n- Kraby\n- Å»aboludzie\n- Golemy (kamienny i bagienny)\n- Harpie (zwykÅ‚e i czarne)\n- PeÅ‚zacze (zwykÅ‚e, polne, wojownicy)\n- Szkielety (wojownicy, Å‚ucznicy, kusznicy)\n- ZÄ™bacze, brzytwiaki, smocze zÄ™bacze\n- Zombie\n- Gobliny (zwykÅ‚e, szkielety, wojownicy, czarne)\n- Dziki\n- Bestie (polne oraz leÅ›ne)\n- Trutnie (bagienne oraz Å›ciekowe)\n- Jaszczury (zwykÅ‚e, ogniste, bagienne), aligatory\n- WÄ™Å¼e\n- Topielce (zwykÅ‚e i morskie)\n- Kretoszczury\n- Szczury (olbrzymie, bagienne, czarne)\n- Åšcierwojady (zwykÅ‚e i leÅ›ne)\n- Wilki, czarne wilki, wargi, orkowe psy\n- BÅ‚otniaki\n- Cieniostwory (zwykÅ‚e i szkielety)\n- Trolle (zwykÅ‚e, bagienne, jaskiniowe)\n\n**Kroniki Myrtany: Archolos - Opis FabuÅ‚y**:\n\n* **Prolog:**\n\nNasza podrÃ³Å¼ do Archolos rozpoczyna siÄ™ na statku piratÃ³w, gdzie przyszÅ‚o nam spÄ™dziÄ‡ czas pod pokÅ‚adem z doÅ›Ä‡ barwnÄ… kompaniÄ…. Poznajemy Ruperta, ktÃ³ry narzeka na gÅ‚Ã³d i prosi nas o pomoc w przygotowaniu szaszÅ‚ykÃ³w. Polujemy na szczury, czytamy przepis i przygotowujemy posiÅ‚ek na kuchence, zyskujÄ…c wdziÄ™cznoÅ›Ä‡ Ruperta i przepis na kotlet grzybowy. Urs, stary wilk morski, oferuje nam lekcjÄ™ otwierania zamkÃ³w, wrÄ™czajÄ…c zwÃ³j i wskazujÄ…c skrzyniÄ™, na ktÃ³rej moÅ¼emy przetestowaÄ‡ nowe umiejÄ™tnoÅ›ci. Vrazka wspomina o zgubionej skrzyneczce, ktÃ³rÄ… odnajdujemy przeszukujÄ…c deski niedaleko skrzyni Ursa.  Aske, doÅ›wiadczony Å‚ucznik, chÄ™tnie dzieli siÄ™ swojÄ… wiedzÄ… w zamian za Å‚yk grogu ze skrzyni, uczÄ…c nas strugaÄ‡ strzaÅ‚y. Z Fabio, rozbitkiem o wybuchowym charakterze, moÅ¼emy nawiÄ…zaÄ‡ niÄ‡ porozumienia, oferujÄ…c mu piwo, lub sprowokowaÄ‡ go do bÃ³jki. Przez kraty Å‚adowni zagadujemy do tajemniczego przemytnika, ktÃ³ry rzuca enigmatyczne uwagi na temat wyspy. SpokÃ³j przerywa kapitan, wzywajÄ…cy nas na pokÅ‚ad. JesteÅ›my Å›wiadkami brutalnego traktowania Timo przez zaÅ‚ogÄ™. Stajemy przed trudnym wyborem: stanÄ…Ä‡ w obronie Timo, ryzykujÄ…c gniew kapitana, lub pozostaÄ‡ biernym obserwatorem.  Nasza decyzja zawaÅ¼y na losie Timo â€“ przeÅ¼yje i spotkamy go w Silbach, a pÃ³Åºniej w tej samej gildii co my, lub zginie, a jego ciaÅ‚o i miecz zostanÄ… wyrzucone na brzeg. NiezaleÅ¼nie od wyboru, koÅ„czymy za burtÄ…, wrzuceni w wir wydarzeÅ„ na Archolos.\n\n* **RozdziaÅ‚ 1: WÄ…tek GÅ‚Ã³wny i Poboczny - Silbach**\n\nDopÅ‚ywamy do brzegu i spotykamy Jorna, ktÃ³ry proponuje poszukiwania Ezekiela. Odnajdujemy go pogrÄ…Å¼onego w Å¼aÅ‚obie po stracie cÃ³rki.  MoÅ¼emy przekonaÄ‡ go do pÃ³jÅ›cia z nami, co w przyszÅ‚oÅ›ci zaowocuje jego rolÄ… handlarza w Silbach, lub zostawiÄ‡ go samego sobie, skazujÄ…c na samotnÄ… Å›mierÄ‡ na plaÅ¼y.  PodÄ…Å¼amy za Jornem do reszty rozbitkÃ³w, ktÃ³rym przewodzi Fabio.  JeÅ›li wczeÅ›niej wybraliÅ›my drogÄ™ z Jornem, od razu udajemy siÄ™ do Silbach. JeÅ›li poszliÅ›my z Fabio,  trafiamy do jaskini, gdzie pomagamy w obozowych obowiÄ…zkach.  Fabio prosi nas o zebranie drewna na opaÅ‚. MoÅ¼emy sprÃ³bowaÄ‡ wymigaÄ‡ siÄ™ od zadania, przypominajÄ…c mu o piwie danym na statku, lub  walczÄ…c z nim.  JeÅ›li siÄ™ zgodzimy, zbieramy piÄ™Ä‡ kawaÅ‚kÃ³w chrustu porozrzucanych po okolicy.  MoÅ¼emy teÅ¼ zbadaÄ‡ boczne odnogi jaskini â€“ w jednej walczymy z goblinami, a w drugiej odkrywamy grobowce i pentagram, o ktÃ³rych Fabio prosi nas, byÅ›my nikomu nie wspominali.  NocÄ… obÃ³z atakujÄ… topielce. Wraz z Rupertem oczyszczamy drogÄ™ do Silbach, zabijajÄ…c potwory i odnajdujÄ…c zardzewiaÅ‚y klucz w brzuchu topielca. W Silbach straÅ¼nik wpuszcza nas do wioski, a my w koÅ„cu czujemy siÄ™ bezpiecznie.  W karczmie spotykamy Kurta, ktÃ³ry okazuje siÄ™ byÄ‡ naszym bratem.  DowiedzieliÅ›my siÄ™, Å¼e Jorn zostaÅ‚ ranny przez krwiopijcÄ™ i potrzebuje pomocy.  Kurt kieruje nas do Lokvara, miejscowego maga, ktÃ³ry zgadza siÄ™ przygotowaÄ‡ lekarstwo w zamian za zioÅ‚a.  Zbieramy je z pomocÄ… Riordiana, modlÄ…cego siÄ™ na cmentarzu. Po drodze uczymy siÄ™ zaklÄ™cia telekinezy, ktÃ³re okazuje siÄ™ bardzo przydatne.  Z zioÅ‚ami wracamy do Lokvara. Kurt prosi nas o pomoc dla Albyna, ktÃ³ry potrzebuje ludzi do pracy przy odbudowie mÅ‚yna. Rozpoczynamy rekrutacjÄ™ mieszkaÅ„cÃ³w Silbach, przekonujÄ…c Jorna, Ruperta, Maiwen, LeÄ™, Fabio, Ezekiela, Timo i Kazeema. KaÅ¼dy z nich ma swoje warunki i historie, ktÃ³re musimy poznaÄ‡, by ich przekonaÄ‡.  Po zebraniu ekipy wracamy do Albyna. Jorn proponuje nam trening walki.  Ä†wiczymy z nim, a nastÄ™pnie idziemy do piekarza, gdzie znajdujemy Å›lad pustych butelek.  Trop prowadzi nas do skrzynki przy kocioÅ‚ku, gdzie odkrywamy sekret Jorna.  Wracamy do niego, a nastÄ™pnie udajemy siÄ™ do Kurta, gdzie gotujemy zupÄ™ wedÅ‚ug przepisu i uczymy siÄ™ otwierania zamkÃ³w.  Jorn proponuje nam wyprawÄ™ do winnicy Rity.  Impreza koÅ„czy siÄ™ nieprzytomnoÅ›ciÄ… i przebudzeniem w chacie Kurta.  Kurt prosi nas o zdobycie lekarstwa dla Jorna od Bodowina, alchemika mieszkajÄ…cego niedaleko Silbach.  Bodowin zgadza siÄ™ pomÃ³c za opÅ‚atÄ… lub w zamian za oczyszczenie okolicy jego chaty ze Å›cierwojadÃ³w.  Testujemy eliksir i wracamy z nim do Kurta, gdzie czeka nas niemiÅ‚a niespodzianka â€“ Jorn zostaÅ‚ porwany.\n\n\n* **RozdziaÅ‚ 2: WÄ…tek GÅ‚Ã³wny i Poboczny - Miasto i Okolice**\n\nRozpoczynamy poszukiwania Jorna, przeszukujÄ…c chatÄ™ Kurta i zbierajÄ…c wskazÃ³wki od mieszkaÅ„cÃ³w Silbach. Trop prowadzi do miasta. Aby siÄ™ tam dostaÄ‡, musimy zdobyÄ‡ glejt od Albyna, wykonaÄ‡ zadania dla Petry (dotyczÄ…ce drwali lub kupca Salsera), przekupiÄ‡ straÅ¼nika Edgara lub skorzystaÄ‡ z tajnego wejÅ›cia do kanaÅ‚Ã³w. W mieÅ›cie dowiadujemy siÄ™, Å¼e aby cokolwiek zdziaÅ‚aÄ‡, musimy zostaÄ‡ obywatelem. Rozpoczynamy zbieranie referencji od mieszkaÅ„cÃ³w, wykonujÄ…c dla nich szereg zadaÅ„.  Frida zleca nam polowanie z Allanem, Leon chce, byÅ›my pomogli mu w grze w szachy, Tomas potrzebuje nowych partnerÃ³w handlowych dla swojego browaru, Ramona prosi o pomoc w rozwiÄ…zaniu konfliktu robotniczego, Ruud potrzebuje nastawienia barku, a Tengral chce, byÅ›my pomogli mu w sporze z paladynem Runarem.  Matey z urzÄ™du zleca nam posprzÄ…tanie ulic.  Z referencjami wracamy do Mateya i zostajemy obywatelami.  MoÅ¼emy teraz doÅ‚Ä…czyÄ‡ do StraÅ¼y Miejskiej lub Gildii Kupieckiej.  WÄ…tek Gildii Kupieckiej koncentruje siÄ™ na Å›ledztwie w sprawie przemytu ludzi, ktÃ³re prowadzi nas do  Bursztynowego WybrzeÅ¼a i konfrontacji z Pablo. WÄ…tek StraÅ¼y Miejskiej  rozpoczyna siÄ™ od poszukiwaÅ„ zaginionego oddziaÅ‚u, co prowadzi nas do odkrycia spisku  i infiltracji obozu renegatÃ³w.  Obie Å›cieÅ¼ki prowadzÄ… do Przystani ÅotrÃ³w. W miÄ™dzyczasie wykonujemy liczne zadania poboczne dla mieszkaÅ„cÃ³w miasta i okolic, odkrywajÄ…c ich historie i problemy, takie jak pomoc Otmarowi w znalezieniu pijanego przewodnika, znalezienie schronienia dla Garda, pomoc Ewaldowi w dostawie materiaÅ‚Ã³w, a takÅ¼e rozwiÄ…zujÄ…c mniejsze problemy mieszkaÅ„cÃ³w Silbach.\n\n\n* **RozdziaÅ‚ 3: WÄ…tek GÅ‚Ã³wny i Poboczny - PrzystaÅ„ ÅotrÃ³w**\n\nNa Przystani ÅotrÃ³w spotykamy Corteza i Bena. Jako czÅ‚onkowie Gildii Kupieckiej odzyskujemy skradzione wino zastawiajÄ…c puÅ‚apkÄ™ na bandytÃ³w, a jako straÅ¼nicy badamy morderstwo Stana, co prowadzi do konfrontacji z Rodrigo i Simonem. Poznajemy dawnych znajomych ze statku, m.in. Aske.  Wykonujemy zadania dla Corteza, m.in. odzyskujemy skradzione towary, ratujemy rozbitkÃ³w i szukamy zaginionych ludzi.  Bierzemy udziaÅ‚ w turnieju, walczÄ…c z Larrym, Otisem, Eileen/Javadem, Saulem i w finale z Benem. Po turnieju zdobywamy informacje od Bena na temat Jorna, uÅ¼ywajÄ…c trucizny, by rozwiÄ…zaÄ‡ mu jÄ™zyk. Decydujemy o losie Bena, dajÄ…c mu antidotum lub zostawiajÄ…c na pewnÄ… Å›mierÄ‡.  Z informacjami od Bena wracamy do miasta, by zdaÄ‡ raport Lorenzo/Roderichowi. Na Przystani ÅotrÃ³w wykonujemy teÅ¼ zadania poboczne, takie jak pomoc Saulowi w doprawieniu potrawki, odzyskanie sakiewki Larry'ego, poszukiwanie skarbÃ³w z Moritzem, pomoc Homerowi w ucieczce z niewoli, walki na piÄ™Å›ci w Dzielnicy PiÄ™Å›ci,  a takÅ¼e pomoc Nadine w odnalezieniu cÃ³rki.\n\n\n* **RozdziaÅ‚ 4: WÄ…tek GÅ‚Ã³wny i Poboczny - Wilcze LeÅ¼e**\n\nZ informacjami od Bena wracamy do miasta i dowiadujemy siÄ™ o zamachu na Volkera.  Pomagamy w Å›ledztwie, badajÄ…c trzy tropy: grot, ulotki i wiÄ™Åºnia.  KaÅ¼dy trop prowadzi do innych podejrzanych i wymaga wykonania kolejnych zadaÅ„, takich jak przeszukanie cmentarza, rozmowa z robotnikami i infiltracja wiÄ™zienia. Nasze wybory wpÅ‚ywajÄ… na to, kto ostatecznie zostanie oskarÅ¼ony o zamach i stracony.  Volker wysyÅ‚a nas do Wilczego LeÅ¼a.  Aby siÄ™ tam dostaÄ‡, musimy przekonaÄ‡ uchodÅºcÃ³w do odejÅ›cia lub zabiÄ‡ ich, albo spowodowaÄ‡ lawinÄ™.  WewnÄ…trz LeÅ¼a szukamy wskazÃ³wek dotyczÄ…cych Jorna.  Rozmawiamy z kowalem, ktÃ³ry sprzedaÅ‚ groty uÅ¼yte w zamachu,  i szukamy odpowiedniego Å‚owcy.  Trop prowadzi do Jona w kopalni.  Wykonujemy zadania dla Ulryka, zabijajÄ…c peÅ‚zacze i orkÃ³w.  W kopalni odkrywamy spisek przeciwko Volkerowi.  Odkrywamy teÅ¼ sekretnÄ… kryjÃ³wkÄ™, gdzie znajdujemy mapÄ™ prowadzÄ…cÄ… do miejsca przetrzymywania Jorna.  Uciekamy z LeÅ¼a.  W Wilczym LeÅ¼u wykonujemy rÃ³wnieÅ¼ zadania poboczne, takie jak  pomoc Nelsonowi w zdobyciu rogu cieniostwora, dostarczenie trunkÃ³w dla Dirka, zebranie wilczych skÃ³r dla Baesa,  pomoc Tonanowi w uwolnieniu zjawy, znalezienie koÅ‚a zÄ™batego dla Lucasa, obstawianie walk w obozie Loria,  testowanie eliksirÃ³w przemiany dla Yezegana, polowanie na bestiÄ™ z Archolos dla Ramseya, pomoc drwalowi w dostawie srebra i stali,  peÅ‚nienie nocnej warty dla Aretha, a takÅ¼e rozprawienie siÄ™ z grupÄ… renegatÃ³w odpowiedzialnÄ… za porwanie Jorna.\n\n\n* **RozdziaÅ‚ 5: WÄ…tek GÅ‚Ã³wny i Poboczny - Klasztor MagÃ³w Wody i Twierdza Vardhal**\n\nPo ucieczce z LeÅ¼a trafiamy do Klasztoru MagÃ³w Wody.  Z pomocÄ… Riordiana i Any przygotowujemy miksturÄ™, ktÃ³ra odsÅ‚ania nam wizjÄ™ Twierdzy Vardhal, gdzie przetrzymywany jest Jorn.  W klasztorze wykonujemy zadania dla magÃ³w i nowicjuszy, m.in. uciekamy z laboratorium jako zmniejszona wersja siebie, pomagamy Candakowi uporaÄ‡ siÄ™ z problemem nieumarÅ‚ych na cmentarzu, badamy sprawÄ™ plagi Å›cierwojadÃ³w, szukamy zagubionych przedmiotÃ³w Artura i zbieramy roÅ›liny dla ogrodnika. Przygotowujemy siÄ™ do wyprawy do Vardhal, zbierajÄ…c zapasy i rekrutujÄ…c towarzyszy. WÅ›rÃ³d nich mogÄ… znaleÅºÄ‡ siÄ™ m.in. Bastian, Ezekiel, Viktor, Rupert, Helga, Rita, Tengral, Slager, Bevin, Dima, Tomas, Zachary, Helmud, Knut, Pablo, Ernesto,  Candac, Ilse, Ben, Fane, Caramon, Lutz, Arwid, Berto, Cortez,  Javed i Griff.  W ruinach Vardhal walczymy z nieumarÅ‚ymi, szukamy fragmentÃ³w klucza i odkrywamy tajemnice twierdzy.  Odnajdujemy Jorna i RozjemcÄ™ â€“ legendarny miecz.  Konfrontujemy siÄ™ z Ulrykiem i musimy podjÄ…Ä‡ trudnÄ… decyzjÄ™ â€“ oddaÄ‡ RozjemcÄ™ lub walczyÄ‡.\n\n\n* **RozdziaÅ‚ 6: WÄ…tek GÅ‚Ã³wny i Poboczny - Czarna Godzina**\n\nPo wydarzeniach w Vardhal wracamy do miasta, ktÃ³re jest atakowane przez ludzi Volkera i Wilczych SynÃ³w.  Pomagamy mieszkaÅ„com, bronimy miasta i konfrontujemy siÄ™ z byÅ‚ymi sojusznikami. Nasze wybory w poprzednich rozdziaÅ‚ach determinujÄ…, kogo spotkamy i z kim bÄ™dziemy walczyÄ‡.  Chronimy magÃ³w ognia, walczymy z Yezeganem i Osipem, decydujemy o losie Alferda.  Spotykamy Riordiana, ktÃ³ry oferuje nam wybÃ³r â€“ chroniÄ‡ Archolos lub skupiÄ‡ siÄ™ na zemÅ›cie na Lichwiarzu.  Decyzja ta  wpÅ‚ywa na ostatecznÄ… konfrontacjÄ™ -  z Volkerem lub  bezpoÅ›rednio z Lichwiarzem.  W kanaÅ‚ach spotykamy Ivy i decydujemy o jej losie.  Ostateczna walka z Lichwiarzem/Volkerem koÅ„czy naszÄ… przygodÄ™ na Archolos.\n\n\n**Lista customowych emoji ktÃ³rych moÅ¼esz uÅ¼ywaÄ‡**:\n:5ZLOTYCH:\n:FeelsRetarded:\n:ModOfTheDecade:\n:OmegaLUL:\n:RODERICH:\n:SwagHappy:\n:SwagSmirk:\n:ahaha:\n:anyaheh:\n:banhammer:\n:besmart:\n:beyeszoom:\n:blobStress:\n:blobSus:\n:buffdoge:\n:chadstream:\n:cheems:\n:clownge:\n:ddsanity:\n:depressed:\n:dogecri:\n:dogegun:\n:ehh:\n:engplease:\n:gigachad:\n:gotcha:\n:guessdie:\n:harad4th:\n:haski:\n:haskicri:\n:he:\n:hmm:\n:hmm4:\n:isleep:\n:kekq:\n:kekw:\n:kekwpog:\n:kmlogo:\n:koperek:\n:kz:\n:legit:\n:lullll:\n:marv:\n:marve:\n:marvin:\n:mhm:\n:monkaGIGA:\n:monstereksip:\n:nameless4th:\n:noted:\n:notlikethis:\n:ok_pepe:\n:okzoomer:\n:pOg:\n:pain:\n:pathetic:\n:peepoDrink:\n:peepoParty1:\n:peepoParty2:\n:peepoParty3:\n:peepolove:\n:pepeEZ:\n:pepeToast:\n:pepehands:\n:pepelaugh:\n:pika:\n:plus:\n:potionseller:\n:praisethesun:\n:prayge:\n:reeee:\n:report:\n:sadeg:\n:sadge:\n:salute:\n:shineglasses:\n:shrugtom:\n:skillissue:\n:sleeper:\n:spierdaczka:\n:stonks:\n:susge:\n:sweetpeepo:\n:tea~1:\n:tflmao:\n:thinkingsus:\n:uhoh_Guido:\n:uncannymarv:\n:underdogo:\n:vaana:\n:whatcat:\n:why:\n:wutckle:\n:yes:\n:ziele:\n:MONKE:\n:ahitdance:\n:cashwave:\n:catjam:\n:catreee:\n:cooldoge:\n:dogedance:\n:dogepet:\n:duckdance:\n:ezclap:\n:honkpeepo:\n:kekboom:\n:kekwd:\n:kermitfire:\n:moneyrain:\n:peperain:\n:pogfish:\n:porvalo:\n:pugpls:\n:ratjam:\n:ricardoflick:\n:silphco:\n:susrock:\n:unocard:\n:whoasked:\n\n**Aktywni uÅ¼ytkownicy discorda Kronik Myrtany**:\nrebrond: Wydaje siÄ™ byÄ‡ jednym z najbardziej aktywnych uÅ¼ytkownikÃ³w, czÄ™sto inicjuje rozmowy i zadaje pytania, zarÃ³wno na tematy zwiÄ…zane z Gothiciem, jak i inne. Lubi Å¼artowaÄ‡ i prowokowaÄ‡, czÄ™sto uÅ¼ywa memÃ³w i nawiÄ…zuje do popkultury. Wykazuje siÄ™ rÃ³wnieÅ¼ sporÄ… wiedzÄ… na temat gier, zwÅ‚aszcza serii Gothic i Dark Souls. CzÄ™sto proponuje teÅ¼ wspÃ³lne granie.\n\nnuviusz: Drugi bardzo aktywny uÅ¼ytkownik. Podobnie jak rebrond, chÄ™tnie uczestniczy w rozmowach i zadaje pytania. Jego znakiem rozpoznawczym jest \"lucek\", kot, ktÃ³rego zdjÄ™cia i gify regularnie pojawiajÄ… siÄ™ na czacie. Lubi Å¼artowaÄ‡, czÄ™sto uÅ¼ywajÄ…c sarkazmu i absurdalnego humoru. Interesuje siÄ™ grami, zwÅ‚aszcza Gothic, Ultrakill i Don't Starve Together. Wykazuje siÄ™ teÅ¼ zainteresowaniem tworzeniem gier i pisaniem lore. Mieszka na Podlasiu.\n\ns_h_0_u_n: UÅ¼ytkownik z duÅ¼Ä… wiedzÄ… technicznÄ…, czÄ™sto udziela porad i wyjaÅ›nieÅ„ na tematy zwiÄ…zane z oprogramowaniem, szczegÃ³lnie z moddingiem Gothica i systemami Linux. Jego wypowiedzi sÄ… konkretne i merytoryczne, choÄ‡ czasem uÅ¼ywa mocnego jÄ™zyka. Wydaje siÄ™ byÄ‡ osobÄ… bezpoÅ›redniÄ… i nieco zrzÄ™dliwÄ…, ale chÄ™tnÄ… do pomocy. Z logÃ³w wynika, Å¼e ma kota o imieniu Stefan i boryka siÄ™ z problemami zdrowotnymi.\n\nkubanski: Aktywny uÅ¼ytkownik, chÄ™tnie uczestniczy w rozmowach i dzieli siÄ™ swoimi opiniami na temat gier. Lubi Å¼artowaÄ‡ i uÅ¼ywaÄ‡ memÃ³w. Interesuje siÄ™ szczegÃ³lnie seriÄ… Gothic, Metal Gear Solid i Fear and Hunger. Wydaje siÄ™ byÄ‡ osobÄ… otwartÄ… i towarzyskÄ….\n\nhry123: UÅ¼ytkownik z duÅ¼Ä… wiedzÄ… na temat Gothica, szczegÃ³lnie jego aspektÃ³w technicznych i moddingu. CzÄ™sto udziela pomocy i wskazÃ³wek innym uÅ¼ytkownikom. Jego wypowiedzi sÄ… konkretne i merytoryczne. Interesuje siÄ™ takÅ¼e innymi grami, np. Dark Souls i Left 4 Dead.\n\nx4vv: Aktywny admin jeden z twÃ³rcÃ³w moda Kroniki Myrtany, czÄ™sto inicjuje rozmowy na temat gier, szczegÃ³lnie z gatunku souls-like. Lubi dzieliÄ‡ siÄ™ swoimi opiniami i recenzjami. UÅ¼ywa memÃ³w i czÄ™sto pisze po angielsku. Wykazuje siÄ™ duÅ¼ym zainteresowaniem technologiÄ… i oprogramowaniem, szczegÃ³lnie systemami Linux.\n\nmikhtar: Aktywny uÅ¼ytkownik, chÄ™tnie uczestniczy w rozmowach, zadaje pytania i dzieli siÄ™ swoimi opiniami. Lubi Å¼artowaÄ‡ i uÅ¼ywaÄ‡ memÃ³w, czÄ™sto nawiÄ…zuje do popkultury. Interesuje siÄ™ grami, zwÅ‚aszcza Gothic, Dark Souls i Warhammer.\n\nchristopher9044: Aktywny uÅ¼ytkownik, chÄ™tnie uczestniczy w rozmowach i dzieli siÄ™ swoimi opiniami na temat gier. Lubi Å¼artowaÄ‡ i uÅ¼ywaÄ‡ memÃ³w. Interesuje siÄ™ szczegÃ³lnie seriÄ… Gothic i kotami.\n\n.pwned: Aktywny uÅ¼ytkownik, chÄ™tnie uczestniczy w rozmowach i zadaje pytania. Lubi Å¼artowaÄ‡ i uÅ¼ywaÄ‡ memÃ³w. Interesuje siÄ™ grami i posiada psa rasy husky.\n\n.pawloch: Jeden z twÃ³rcÃ³w Kronik Myrtany.\n\n **PrzykÅ‚ady zdjÄ™Ä‡ postaci z Kronik Myrtany z opisami**:\n\n";

    // Temperature setting - User can modify this (0.0 to 1.0)
    let temperature = 0.7;


    let emoticonsMap = new Map([
        ['5ZLOTYCH', 'https://cdn.discordapp.com/emojis/1306356283330396230.webp?size=48'],
        ['FeelsRetarded', 'https://cdn.discordapp.com/emojis/882010666674819082.webp?size=48'],
        ['ModOfTheDecade', 'https://cdn.discordapp.com/emojis/1023326511601819719.webp?size=48'],
        ['OmegaLUL', 'https://cdn.discordapp.com/emojis/859536449698922516.webp?size=48'],
        ['RODERICH', 'https://cdn.discordapp.com/emojis/1256335874820542665.webp?size=48'],
        ['SwagHappy', 'https://cdn.discordapp.com/emojis/954923570180546570.webp?size=48'],
        ['SwagSmirk', 'https://cdn.discordapp.com/emojis/1295101966938275880.webp?size=48'],
        ['ahaha', 'https://cdn.discordapp.com/emojis/954407468555964476.webp?size=48'],
        ['anyaheh', 'https://cdn.discordapp.com/emojis/964169768896696322.webp?size=48'],
        ['banhammer', 'https://cdn.discordapp.com/emojis/909140380493185056.webp?size=48'],
        ['besmart', 'https://cdn.discordapp.com/emojis/909140839073206272.webp?size=48'],
        ['beyeszoom', 'https://cdn.discordapp.com/emojis/880543180930564157.webp?size=48'],
        ['blobStress', 'https://cdn.discordapp.com/emojis/965086711749173248.webp?size=48'],
        ['blobSus', 'https://cdn.discordapp.com/emojis/967861608606998558.webp?size=48'],
        ['buffdoge', 'https://cdn.discordapp.com/emojis/909825598430515200.webp?size=48'],
        ['chadstream', 'https://cdn.discordapp.com/emojis/958346334497292308.webp?size=48'],
        ['cheems', 'https://cdn.discordapp.com/emojis/853278456330190868.webp?size=48'],
        ['clownge', 'https://cdn.discordapp.com/emojis/934195588810043452.webp?size=48'],
        ['ddsanity', 'https://cdn.discordapp.com/emojis/1049765343461134407.webp?size=48'],
        ['depressed', 'https://cdn.discordapp.com/emojis/979438675194691625.webp?size=48'],
        ['dogecri', 'https://cdn.discordapp.com/emojis/887401571363733674.webp?size=48'],
        ['dogegun', 'https://cdn.discordapp.com/emojis/909447431681368134.webp?size=48'],
        ['ehh', 'https://cdn.discordapp.com/emojis/1299473675665539076.webp?size=48'],
        ['engplease', 'https://cdn.discordapp.com/emojis/910196983984164904.webp?size=48'],
        ['gigachad', 'https://cdn.discordapp.com/emojis/853268431130066955.webp?size=48'],
        ['gotcha', 'https://cdn.discordapp.com/emojis/956115382454845520.webp?size=48'],
        ['guessdie', 'https://cdn.discordapp.com/emojis/938057411439263744.webp?size=48'],
        ['harad4th', 'https://cdn.discordapp.com/emojis/944697650417119252.webp?size=48'],
        ['haski', 'https://cdn.discordapp.com/emojis/1099000450021335132.webp?size=48'],
        ['haskicri', 'https://cdn.discordapp.com/emojis/1099069706515796101.webp?size=48'],
        ['he', 'https://cdn.discordapp.com/emojis/1006334359181201438.webp?size=48'],
        ['hmm', 'https://cdn.discordapp.com/emojis/954401284964876308.webp?size=48'],
        ['hmm4', 'https://cdn.discordapp.com/emojis/1079721727891869756.webp?size=48'],
        ['isleep', 'https://cdn.discordapp.com/emojis/934220335274930236.webp?size=48'],
        ['kekq', 'https://cdn.discordapp.com/emojis/955796239943884800.webp?size=48'],
        ['kekw', 'https://cdn.discordapp.com/emojis/853275799993712640.webp?size=48'],
        ['kekwpog', 'https://cdn.discordapp.com/emojis/906011370678526012.webp?size=48'],
        ['kmlogo', 'https://cdn.discordapp.com/emojis/874302609253605386.webp?size=48'],
        ['koperek', 'https://cdn.discordapp.com/emojis/883466586990735440.webp?size=48'],
        ['kz', 'https://cdn.discordapp.com/emojis/885991644283949147.webp?size=48'],
        ['legit', 'https://cdn.discordapp.com/emojis/934195594157776937.webp?size=48'],
        ['lullll', 'https://cdn.discordapp.com/emojis/859396689655758878.webp?size=48'],
        ['marv', 'https://cdn.discordapp.com/emojis/1240020801575452705.webp?size=48'],
        ['marve', 'https://cdn.discordapp.com/emojis/920300862738427985.webp?size=48'],
        ['marvin', 'https://cdn.discordapp.com/emojis/909227359641686026.webp?size=48'],
        ['mhm', 'https://cdn.discordapp.com/emojis/954403979931050094.webp?size=48'],
        ['monkaGIGA', 'https://cdn.discordapp.com/emojis/882010666523848746.webp?size=48'],
        ['monstereksip', 'https://cdn.discordapp.com/emojis/931017311559770113.webp?size=48'],
        ['nameless4th', 'https://cdn.discordapp.com/emojis/944697636353630258.webp?size=48'],
        ['noted', 'https://cdn.discordapp.com/emojis/882010666641272893.webp?size=48'],
        ['notlikethis', 'https://cdn.discordapp.com/emojis/881244910878077038.webp?size=48'],
        ['ok_pepe', 'https://cdn.discordapp.com/emojis/962749480728428574.webp?size=48'],
        ['okzoomer', 'https://cdn.discordapp.com/emojis/910197005844893776.webp?size=48'],
        ['pOg', 'https://cdn.discordapp.com/emojis/853251919287418890.webp?size=48'],
        ['pain', 'https://cdn.discordapp.com/emojis/877218846354866186.webp?size=48'],
        ['pathetic', 'https://cdn.discordapp.com/emojis/909142031396388954.webp?size=48'],
        ['peepoDrink', 'https://cdn.discordapp.com/emojis/1057246000617635870.webp?size=48'],
        ['peepoParty1', 'https://cdn.discordapp.com/emojis/1057244077017534524.webp?size=48'],
        ['peepoParty2', 'https://cdn.discordapp.com/emojis/1057244096776900668.webp?size=48'],
        ['peepoParty3', 'https://cdn.discordapp.com/emojis/1057244119874928650.webp?size=48'],
        ['peepolove', 'https://cdn.discordapp.com/emojis/853251901943316560.webp?size=48'],
        ['pepeEZ', 'https://cdn.discordapp.com/emojis/888034795345571860.webp?size=48'],
        ['pepeToast', 'https://cdn.discordapp.com/emojis/1057244050966728734.webp?size=48'],
        ['pepehands', 'https://cdn.discordapp.com/emojis/875401613827772488.webp?size=48'],
        ['pepelaugh', 'https://cdn.discordapp.com/emojis/887087414928080986.webp?size=48'],
        ['pika', 'https://cdn.discordapp.com/emojis/909142687842725938.webp?size=48'],
        ['plus', 'https://cdn.discordapp.com/emojis/853279501688897588.webp?size=48'],
        ['potionseller', 'https://cdn.discordapp.com/emojis/934195608921722920.webp?size=48'],
        ['praisethesun', 'https://cdn.discordapp.com/emojis/882010666871947274.webp?size=48'],
        ['prayge', 'https://cdn.discordapp.com/emojis/934195565934301274.webp?size=48'],
        ['reeee', 'https://cdn.discordapp.com/emojis/882010666800676885.webp?size=48'],
        ['report', 'https://cdn.discordapp.com/emojis/909496703550373949.webp?size=48'],
        ['sadeg', 'https://cdn.discordapp.com/emojis/938056614223687731.webp?size=48'],
        ['sadge', 'https://cdn.discordapp.com/emojis/934195518836457482.webp?size=48'],
        ['salute', 'https://cdn.discordapp.com/emojis/882010666301530155.webp?size=48'],
        ['shineglasses', 'https://cdn.discordapp.com/emojis/934195612474310666.webp?size=48'],
        ['shrugtom', 'https://cdn.discordapp.com/emojis/938057420939341864.webp?size=48'],
        ['skillissue', 'https://cdn.discordapp.com/emojis/1099343364136120350.webp?size=48'],
        ['sleeper', 'https://cdn.discordapp.com/emojis/958641187596685312.webp?size=48'],
        ['spierdaczka', 'https://cdn.discordapp.com/emojis/1279557887881904128.webp?size=48'],
        ['stonks', 'https://cdn.discordapp.com/emojis/881680669506424833.webp?size=48'],
        ['susge', 'https://cdn.discordapp.com/emojis/924538989522853899.webp?size=48'],
        ['sweetpeepo', 'https://cdn.discordapp.com/emojis/882009031672229948.webp?size=48'],
        ['tea~1', 'https://cdn.discordapp.com/emojis/853251929374326785.webp?size=48'],
        ['tflmao', 'https://cdn.discordapp.com/emojis/954400960548065432.webp?size=48'],
        ['thinkingsus', 'https://cdn.discordapp.com/emojis/910208312497299486.webp?size=48'],
        ['uhoh_Guido', 'https://cdn.discordapp.com/emojis/954423830036750466.webp?size=48'],
        ['uncannymarv', 'https://cdn.discordapp.com/emojis/931294296999604294.webp?size=48'],
        ['underdogo', 'https://cdn.discordapp.com/emojis/988526761933434910.webp?size=48'],
        ['vaana', 'https://cdn.discordapp.com/emojis/1161043050500464691.webp?size=48'],
        ['whatcat', 'https://cdn.discordapp.com/emojis/909143204396425246.webp?size=48'],
        ['why', 'https://cdn.discordapp.com/emojis/958670938809987112.webp?size=48'],
        ['wutckle', 'https://cdn.discordapp.com/emojis/934195602751885352.webp?size=48'],
        ['yes', 'https://cdn.discordapp.com/emojis/853268442457833482.webp?size=48'],
        ['ziele', 'https://cdn.discordapp.com/emojis/909227348400959509.webp?size=48'],
        ['MONKE', 'https://cdn.discordapp.com/emojis/909508579004928042.webp?size=48&animated=true'],
        ['ahitdance', 'https://cdn.discordapp.com/emojis/909507272009474078.webp?size=48&animated=true'],
        ['cashwave', 'https://cdn.discordapp.com/emojis/915026532433543198.webp?size=48&animated=true'],
        ['catjam', 'https://cdn.discordapp.com/emojis/909454894958788710.webp?size=48&animated=true'],
        ['catreee', 'https://cdn.discordapp.com/emojis/909496679835787285.webp?size=48&animated=true'],
        ['cooldoge', 'https://cdn.discordapp.com/emojis/909825495137403011.webp?size=48&animated=true'],
        ['dogedance', 'https://cdn.discordapp.com/emojis/909508930248536085.webp?size=48&animated=true'],
        ['dogepet', 'https://cdn.discordapp.com/emojis/909496040258957362.webp?size=48&animated=true'],
        ['duckdance', 'https://cdn.discordapp.com/emojis/909507286769205289.webp?size=48&animated=true'],
        ['ezclap', 'https://cdn.discordapp.com/emojis/909496651822014464.webp?size=48&animated=true'],
        ['honkpeepo', 'https://cdn.discordapp.com/emojis/909144840711843901.webp?size=48&animated=true'],
        ['kekboom', 'https://cdn.discordapp.com/emojis/909454862226452530.webp?size=48&animated=true'],
        ['kekwd', 'https://cdn.discordapp.com/emojis/909496642271600663.webp?size=48&animated=true'],
        ['kermitfire', 'https://cdn.discordapp.com/emojis/909825510928945203.webp?size=48&animated=true'],
        ['moneyrain', 'https://cdn.discordapp.com/emojis/910196994952278036.webp?size=48&animated=true'],
        ['peperain', 'https://cdn.discordapp.com/emojis/909507301910671360.webp?size=48&animated=true'],
        ['pogfish', 'https://cdn.discordapp.com/emojis/909507757894406197.webp?size=48&animated=true'],
        ['porvalo', 'https://cdn.discordapp.com/emojis/954399111287832616.webp?size=48&animated=true'],
        ['pugpls', 'https://cdn.discordapp.com/emojis/909496531302907984.webp?size=48&animated=true'],
        ['ratjam', 'https://cdn.discordapp.com/emojis/909508562005405736.webp?size=48&animated=true'],
        ['ricardoflick', 'https://cdn.discordapp.com/emojis/909508205414055976.webp?size=48&animated=true'],
        ['silphco', 'https://cdn.discordapp.com/emojis/934199536904175726.webp?size=48&animated=true'],
        ['susrock', 'https://cdn.discordapp.com/emojis/934198916340154448.webp?size=48&animated=true'],
        ['unocard', 'https://cdn.discordapp.com/emojis/909496073502982184.webp?size=48&animated=true'],
        ['whoasked', 'https://cdn.discordapp.com/emojis/909496585728180264.webp?size=48&animated=true']
    ]);


let chatHistory = [

    ];



// Replace your existing aiChatHistory with this:
let aiChatHistory = [
];
  
let userChatHistory = [];

function encodeImageFileAsBase64(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onloadend = () => resolve(reader.result.split(',')[1]);
        reader.onerror = (error) => reject(error);
        reader.readAsDataURL(file);
    });
}


// Function to parse emoticons in a message
function parseEmoticons(message) {
    const emoticonRegex = /:([^:\s]+):/g;
    return message.replace(emoticonRegex, (match, emoticonName) => {
        const emoticonKey = [...emoticonsMap.keys()].find(key => key.toLowerCase() === emoticonName.toLowerCase());
        if (emoticonKey) {
            const emoticonUrl = emoticonsMap.get(emoticonKey);
            return `<img src="${emoticonUrl}" alt=":${emoticonKey}:" style="display: inline-block; vertical-align: middle; height: 24px;">`;
        }
        return ''; // Return empty string for emojis not in the map instead of returning the match
    });
}




// Function to add a message to the chat container with streaming for AI responses
async function addMessage(message, isUser = false, imageData = null, imageName = null) {
    const chatContainer = document.getElementById('chat-container');
    const messageContainer = document.createElement('div');
    messageContainer.className = `message-container ${isUser ? 'user-message-container' : ''}`;

    const avatar = document.createElement('img');
    avatar.className = `avatar ${isUser ? 'user' : ''}`;
    avatar.src = isUser ? 'default.png' : 'spierdaczka.png';
    messageContainer.appendChild(avatar);

    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;

    if (imageData && !isUser && imageName) {  // AI image
        const img = document.createElement('img');
        img.src = `data:image/jpeg;base64,${imageData}`;
        img.alt = imageName;
        img.style.maxWidth = '200px'; img.style.maxHeight = '200px';
        messageDiv.appendChild(img);
    } else if (imageData && isUser) {           // User image
        const img = document.createElement('img');
        img.src = `data:image/jpeg;base64,${imageData}`;
        img.alt = imageName || "Uploaded Image";
        img.style.maxWidth = '200px'; img.style.maxHeight = '200px';
        messageDiv.appendChild(img);
    }

    if (message) {
        messageDiv.innerHTML += parseEmoticons(message.replace(/\n/g, '<br>'));
    }

    messageContainer.appendChild(messageDiv);
    chatContainer.appendChild(messageContainer);
    chatContainer.scrollTop = chatContainer.scrollHeight;
}

// Function to stream the AI response text
async function streamResponse(message, messageDiv) {
    let streamedText = "";
    for (let char of message) {
        streamedText += char;
        messageDiv.innerHTML = parseEmoticons(streamedText.replace(/\n/g, '<br>'));
        await new Promise(resolve => setTimeout(resolve, 20));
    }
}

let uploadedImageData = null;
let uploadedImageName = null;

function handleFileSelect(event) {
    const file = event.target.files[0];
    if (file) {
        uploadedImageName = file.name; // Store the uploaded image name
        encodeImageFileAsBase64(file)
            .then(base64data => {
                uploadedImageData = base64data; // Temporarily store image data
                //alert(`Image "${uploadedImageName}" uploaded! You can now add a message and click Send.`);
            })
            .catch(error => {
                console.error("Error encoding image:", error);
            });
    }
}

// Event listener for the image upload button
document.getElementById('image-upload').addEventListener('change', handleFileSelect);
document.getElementById('upload-image-button').addEventListener('click', () => {
    document.getElementById('image-upload').click();
});


// Function to send user input and/or image data to the AI API
async function generateResponse(userMessage, imageData = null, imageName = null) {
    let combinedHistory = [...aiChatHistory, ...userChatHistory];

    // Start with the system prompt
    let parts = [{ text: systemPrompt + "\n\n" }]; // System prompt FIRST

    let firstUserMessageAdded = false; // Flag to track if the first user message has been added

    for (const msg of combinedHistory) {
        if (msg.role === 'user' && !firstUserMessageAdded) {
            // Insert the start of the conversation text before the first user message
            parts.push({ text: "==== PoczÄ…tek rozmowy ====\n\n" });
            firstUserMessageAdded = true;
        }

        if (msg.role) {
            parts.push({ text: `${msg.role}: ` });
        }

        // Add the text content if it exists
        if (msg.content) {
            parts.push({ text: msg.content + "\n" });
        }

        // Add the image if it exists
        if (msg.imageData && msg.imageName) {
            parts.push({
                inline_data: {
                    mime_type: "image/jpeg",
                    data: msg.imageData
                }
            });
        }
    }

    // Add the current user message and image (ONLY if present)
    if (userMessage) {
        if (!firstUserMessageAdded) {
            // Add the start of conversation text before the current user message
            parts.push({ text: "==== Start of conversation with user ====\n\n" });
            firstUserMessageAdded = true;
        }
        parts.push({ text: `user: ${userMessage}\n` });
    }

    if (imageData && imageName) { // Check both are present to avoid duplication
        parts.push({
            inline_data: {
                mime_type: "image/jpeg", // Or correct MIME type
                data: imageData
            }
        });
    }

    const data = {
        contents: [{ parts: parts }],
        generationConfig: { temperature }
    };

    console.log("Payload being sent to API:");
    console.log(JSON.stringify(data, null, 2));

    const models = ['gemini-1.5-pro', 'gemini-2.0-flash-exp', 'gemini-exp-1206', 'gemini-exp-1121', 'gemini-exp-1114'];
    const fallbackModel = 'gemini-1.5-flash';
    const apiKeys = [apiKey1, apiKey2]; // Use both API keys

    // Try each API key in sequence
    for (const apiKey of apiKeys) {
        for (const model of models) {
            console.log(`Attempting to send request to model: ${model}`);
            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const result = await response.json();
                    console.log(`Response from model ${model}:`, result);

                    const textContent = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (textContent) {
                        const cleanedResponse = cleanResponse(textContent);

                        // Extract potential image from AI's response
                        const imageDescriptionMatch = cleanedResponse.match(/\[DoÅ‚Ä…czono zdjÄ™cie o nazwie: "(.*?)"\]/);
                        let imageNameFromResponse = null;
                        let imageDataFromResponse = null;

                        if (imageDescriptionMatch) {
                            imageNameFromResponse = imageDescriptionMatch[1];
                            cleanedResponse = cleanedResponse.replace(imageDescriptionMatch[0], ''); // Remove description

                            const imagePart = result?.candidates?.[0]?.content?.parts?.[1];
                            if (imagePart && imagePart.inline_data && imagePart.inline_data.data) {
                                imageDataFromResponse = imagePart.inline_data.data;
                            }
                        }
                        return { cleanedResponse, imageDataFromResponse, imageNameFromResponse };
                    } else {
                        console.warn(`Model ${model} returned no valid content.`);
                    }
                } else {
                    console.error(`Failed response from model ${model}: Status ${response.status}`);
                }

            } catch (error) {
                console.error(`Error with model ${model} and API key ${apiKey}:`, error);
            }
        }
    }

    // If all attempts fail, try the fallback model with both API keys
    for (const apiKey of apiKeys) {
        try {
            console.log(`Attempting fallback model: ${fallbackModel} with API key: ${apiKey}`);
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${fallbackModel}:generateContent?key=${apiKey}`;
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const result = await response.json();
                const textContent = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                if (textContent) {
                    const cleanedResponse = cleanResponse(textContent);
                    return { cleanedResponse, imageDataFromResponse: null, imageNameFromResponse: null };
                }
            } else {
                console.error(`Fallback model failed with API key ${apiKey}: Status ${response.status}`);
            }
        } catch (error) {
            console.error(`Error with fallback model ${fallbackModel} and API key ${apiKey}:`, error);
        }
    }

    // If everything fails
    return { cleanedResponse: "CoÅ› siÄ™ zesraÅ‚o :ehh:", imageDataFromResponse: null, imageNameFromResponse: null };
}





// Function to handle user message input and initiate response generation
async function handleMessage() {
    const input = document.getElementById('message-input');
    const userMessage = input.value.trim();

    if (!userMessage && !uploadedImageData) return;

    addMessage(userMessage, true, uploadedImageData, uploadedImageName); // Add to UI

    userChatHistory.push({
    role: "user",
    content: userMessage || null,
    imageData: uploadedImageData || null,
    imageName: uploadedImageName || null
});



    input.value = '';
    const imageDataToSend = uploadedImageData;
    const imageNameToSend = uploadedImageName;
    uploadedImageData = null;
    uploadedImageName = null;

    const { cleanedResponse, imageDataFromResponse, imageNameFromResponse } = await generateResponse(userMessage, imageDataToSend, imageNameToSend);
    addMessage(cleanedResponse, false, imageDataFromResponse, imageNameFromResponse);

    userChatHistory.push({
    role: "model",
    content: cleanedResponse,
    imageData: imageDataFromResponse || null,
    imageName: imageNameFromResponse || null
});
}

// Event listeners for sending messages
document.getElementById('send-button').addEventListener('click', handleMessage);
document.getElementById('message-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        handleMessage();
    }
});



// Function to clean responses by removing user prefixes
function cleanResponse(response) {
    const userPatterns = [
        /user:/i,
        /human:/i,
        /question:/i,
        /\[user\]/i,
        /\[human\]/i,
        /\[question\]/i
    ];

    let cleanedResponse = response;
    for (const pattern of userPatterns) {
        const index = cleanedResponse.search(pattern);
        if (index !== -1) {
            cleanedResponse = cleanedResponse.substring(0, index).trim();
            break;
        }
    }

    const secondCheck = userPatterns.some(pattern => pattern.test(cleanedResponse));
    if (secondCheck) {
        return cleanResponse(cleanedResponse);
    }
    return cleanedResponse;
}
document.getElementById('send-button').addEventListener('click', handleMessage);

document.addEventListener('DOMContentLoaded', () => {
createRoderich();
chatHistory.forEach(entry => {
        addMessage(entry.parts[0].text, entry.role === "user", entry.imageData, entry.imageName);
    });
const input = document.getElementById('message-input');
const sendButton = document.getElementById('send-button');

input.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        handleMessage();
    }
});

sendButton.addEventListener('click', handleMessage);
});

    function createRoderich() {
        const randomYPosition = Math.random() * 68;
        //console.log('Generated yPosition:', randomYPosition);

        const config = {
            size: '50px',
            rotation: '60deg',
            duration: '3s',
            timing: 'ease-in-out',
            xPosition: '0px',
            yPosition: `${randomYPosition}vh`, // Apply random value
            peekInterval: 5000,
            peekProbability: 0.2
        };

        const roderich = document.createElement('img');
        roderich.src = 'roderich.png';
        roderich.className = 'roderich';
        
        roderich.style.setProperty('--roderich-size', config.size);
        roderich.style.setProperty('--peek-rotation', config.rotation);
        roderich.style.setProperty('--peek-duration', config.duration);
        roderich.style.setProperty('--peek-timing', config.timing);
        roderich.style.setProperty('--x-position', config.xPosition);
        roderich.style.setProperty('--y-position', config.yPosition);
        
        document.body.appendChild(roderich);

        function makeRoderichPeek() {
            const side = Math.random() < 0.5 ? 'left' : 'right';

            // Generate a random Y position between 0 and 90
            const randomYPosition = Math.random() * 68;
            //console.log('Generated Y position for peek:', randomYPosition);

            // Apply the random Y position to the roderich element
            roderich.style.top = `${randomYPosition}vh`;

            if (side === 'left') {
                roderich.style.left = '0';
                roderich.style.right = 'auto';
                roderich.style.animation = `peekabooLeft ${config.duration} ${config.timing}`;
            } else {
                roderich.style.right = '0';
                roderich.style.left = 'auto';
                roderich.style.animation = `peekabooRight ${config.duration} ${config.timing}`;
            }

            setTimeout(() => {
                roderich.style.animation = 'none';
            }, parseFloat(config.duration) * 1000);
        }

        setTimeout(makeRoderichPeek, 1000);

        setInterval(() => {
            if (Math.random() < config.peekProbability) {
                makeRoderichPeek();
            }
        }, config.peekInterval);
    }
</script>
</body>
</html>